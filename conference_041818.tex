\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{courier}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Improving Join Reordering for SQL on Big Data Systems without Statistics\\
}

\author{\IEEEauthorblockN{Amogh Margoor}
\IEEEauthorblockA{\textit{Qubole Inc.} \\
Santa Clara, US}
\and
\IEEEauthorblockN{ Mayur Bhosale}
\IEEEauthorblockA{\textit{Qubole Inc.} \\
Bangalore, India}
}

\maketitle

\begin{abstract}
Traditional Cost Based Optimization in Query processing are not effective for SQL on Big Data due to lack of statistics. Statistics are mostly absent for Big Data Tables as they are expensive to compute and needs frequent recompute due to velocity of data change. 
SQL Join orders is critical for the efficiency and performance of analytical workloads for Big Data. On Qubole Data Service, customers process around 4 million Joins per month just on Apache Spark. With lack of statistics traditional algorithms for reordering the Join implemented in prominent Big Data engines are ineffective. Hence, ensuring optimal order of Joins for Big Data  is still largely a manual process done via trial and error method. Hence, we would like to propose a novel greedy algorithm for Join Reordering which doesn't need expensive computation of Table statistics. Proposed technique is of linear complexity in terms of number of join. We have observed it improving query performance upto 28\% on TPCDS of 1000 scale.
\end{abstract}

\begin{IEEEkeywords}
SQL on Big Data, Query Processing, Join Order, Data Management Systems
\end{IEEEkeywords}

\section{Introduction}
Joins are extremely common for analytical workloads on Big Data. At Qubole, we offer 3 prominent SQL engines for Big Data as a service: Apache Hive, Presto and Apache Spark. Customers using Qubole Data Service processes 4 million joins per month using just Apache Spark, making it one of the most commonly used SQL operators. Table \ref{tab:stats} specifies some of the Join metrics we collected for a month on Qubole's offering of Apache Spark. We see around 51\% of joins being INNER JOIN and around 55\% of all Joins using Merge Sort Join algorithm. Due to both frequency and the complexity of Joins, Join Order and Join Strategy are two important decision to be made by Optimizers. Optimizers of these Big Data engines like Apache Spark uses traditional Dynamic Programming based algorithms \cite{b1} dependent on column level Statistics. Although Join Reordering is extensively researched problem, the techniques are largely dependent on availability statistics. For instance, Join reordering algorithm in Spark and Presto will not work without column level statistics.  Such extensive Statistics are absent for Big Data workloads as they are expensive to compute and maintain. So the Join Reordering rules are never kicked in, leaving it up to the users to take care of it. Since this critical operation is still manual and  requires trial and error method, we would like to propose technique which can work on just the table sizes which can be computed during planning stage even if absent in a cheap manner.

In following subsection we would cover in details the importance of Join Reordering for widely used Join algorithm in Presto and Apache Spark. We will then present the current state of Reordering algorithm and Statistics in the prominent Big Data engines and uncover the reasons to consider new algorithm.

\begin{table}[h]
\begin{center}
\begin{tabular}{ |c|c| } 
 \hline \\
Joins Processed & 3.9 million \\ \hline \\
Most common Join Type & INNER JOIN - 51\%  \\  \hline \\
Second most common Join Type &  LEFT OUTER JOIN - 31\%\\ \hline  \\
Most common Join algorithm & SortMergeJoin - 55\%\\ \hline \\
Second most common Join algorithm & BroadcastHashJoin - 44\%\\
 \hline
\end{tabular}
\caption{Join metrics collected over 1 month for Apache Spark in Qubole}
\label{tab:stats}
\end{center}
\end{table}

\input{why_jo}
\input{current_state_in_bigdata}

\input{literature_survey}

\input{jo}
\input{experimental_evaluation}

\section*{Acknowledgment}

\begin{thebibliography}{00}
\bibitem{b1} Selinger, P. Griffiths, M. M., Astrahan, D. D., Chamberlin, R. A., Lorie, and T. G., Price. ``Access Path Selection in a Relational Database Management System.`` . In Proceedings of the 1979 ACM SIGMOD International Conference on Management of Data (pp. 23â€“34). Association for Computing Machinery, 1979.
\bibitem{b2} Amogh Margoor, Rajat Venkatesh. ``SQL Join Optimizations in Qubole Presto,``
https://medium.com/qubole-engineering/sql-join-optimizations-in-qubole-presto-3ced3dc75275, unpublished 
\end{thebibliography}

\end{document}
